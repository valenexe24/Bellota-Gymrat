<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Bellota Gym Run üíö</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #000;
    height: 100%;
    touch-action: manipulation;
  }

  canvas {
    display: block;
    width: 100vw;
    height: 100vh;
    background: url('https://raw.githubusercontent.com/valenexe24/Bellota-Gymrat/main/gym.jpg') center/cover no-repeat;
  }

  #messageBox {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.85);
    color: #00ff66;
    font-family: monospace;
    font-size: 1.5em;
    padding: 25px 40px;
    border-radius: 15px;
    text-align: center;
    display: none;
    z-index: 10;
    box-shadow: 0 0 15px #00ff66;
  }

  #touchArea {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: 5;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="messageBox"></div>
<div id="touchArea"></div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const messageBox = document.getElementById("messageBox");
const touchArea = document.getElementById("touchArea");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const gravity = 0.7;
let gameSpeed = 6;
let score = 0;
let lives = 3;
let gameOver = false;
let scale = canvas.height / 800; // escala din√°mica

// üü¢ Bellota (jugadora)
const player = {
  x: 80 * scale,
  y: 0,
  width: 70 * scale,
  height: 70 * scale,
  dy: 0,
  jumping: false,
  jumpScale: 1,
  img: new Image(),
};
player.img.src = "https://raw.githubusercontent.com/valenexe24/Bellota-Gymrat/main/Buttercup.jpg";

// üü´ Piso
const ground = {
  y: canvas.height - 100 * scale,
  height: 100 * scale,
};

// üèãÔ∏è Obst√°culos (mancuernas)
let obstacles = [];
let lastObstacleTime = 0;

function createObstacle() {
  const now = Date.now();
  if (now - lastObstacleTime < 1500) return; // m√°s separaci√≥n
  const size = 35 * scale;
  obstacles.push({
    x: canvas.width,
    y: ground.y - size,
    width: size * 2.2,
    height: size,
  });
  lastObstacleTime = now;
}

// Dibujar piso tipo baldosa
function drawGround() {
  ctx.fillStyle = "#222";
  ctx.fillRect(0, ground.y, canvas.width, ground.height);
  ctx.strokeStyle = "#333";
  for (let i = 0; i < canvas.width; i += 40 * scale) {
    ctx.beginPath();
    ctx.moveTo(i, ground.y);
    ctx.lineTo(i + 20 * scale, ground.y + ground.height);
    ctx.stroke();
  }
}

// Bellota con animaci√≥n de salto
function drawPlayer() {
  ctx.save();
  ctx.translate(player.x + player.width / 2, player.y + player.height / 2);
  ctx.scale(player.jumpScale, player.jumpScale);
  ctx.drawImage(player.img, -player.width / 2, -player.height / 2, player.width, player.height);
  ctx.restore();
}

// Dibujar mancuernas realistas
function drawObstacles() {
  obstacles.forEach(ob => {
    const midY = ob.y + ob.height / 2;
    const barHeight = ob.height * 0.25;
    const discRadius = ob.height * 0.45;

    // Barra central
    ctx.fillStyle = "#888";
    ctx.fillRect(ob.x, midY - barHeight / 2, ob.width, barHeight);

    // Discos laterales
    ctx.fillStyle = "#333";
    ctx.beginPath();
    ctx.arc(ob.x, midY, discRadius, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.arc(ob.x + ob.width, midY, discRadius, 0, Math.PI * 2);
    ctx.fill();

    // Detalles met√°licos
    ctx.strokeStyle = "#666";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(ob.x, midY, discRadius, 0, Math.PI * 2);
    ctx.stroke();
    ctx.beginPath();
    ctx.arc(ob.x + ob.width, midY, discRadius, 0, Math.PI * 2);
    ctx.stroke();
  });
}

function updatePlayer() {
  if (player.jumping) {
    player.dy += gravity;
    player.y += player.dy;
    player.jumpScale = 1 + Math.sin(Date.now() / 150) * 0.05; // animaci√≥n sutil
    if (player.y > ground.y - player.height) {
      player.y = ground.y - player.height;
      player.dy = 0;
      player.jumping = false;
      player.jumpScale = 1;
    }
  }
}

function updateObstacles() {
  obstacles.forEach(ob => ob.x -= gameSpeed);
  if (obstacles.length === 0 || obstacles[obstacles.length - 1].x < canvas.width - 400 * scale) {
    createObstacle();
  }
  obstacles = obstacles.filter(ob => ob.x + ob.width > 0);
}

function detectCollision() {
  obstacles.forEach((ob, i) => {
    if (
      player.x < ob.x + ob.width &&
      player.x + player.width > ob.x &&
      player.y + player.height > ob.y
    ) {
      obstacles.splice(i, 1);
      loseLife();
    }
  });
}

function loseLife() {
  lives--;
  if (lives <= 0) {
    endGame();
  } else {
    resetAfterHit();
  }
}

function resetAfterHit() {
  player.y = ground.y - player.height;
  player.dy = 0;
  player.jumping = false;
}

function endGame() {
  gameOver = true;
  showMessage();
}

function showMessage() {
  const foods = [
    "bud√≠n de zanahoria üç∞",
    "pastas caseras üçù",
    "pepas con membrillo üç™",
    "galletitas de avena ü•£",
    "alfajores de maicena üßÅ",
    "pepas con chocolate üç´"
  ];
  messageBox.style.display = "block";
  let time = 0;
  const interval = setInterval(() => {
    messageBox.textContent = "PERDISTE üíö Ten√©s que cocinarme... " + foods[Math.floor(Math.random() * foods.length)];
    time += 100;
    if (time >= 3000) {
      clearInterval(interval);
      const finalFood = foods[Math.floor(Math.random() * foods.length)];
      messageBox.textContent = "PERDISTE üíö Ten√©s que cocinarme... " + finalFood;
    }
  }, 150);
}

function drawHUD() {
  ctx.fillStyle = "#00ff66";
  ctx.font = `${18 * scale}px monospace`;
  ctx.fillText("Score: " + score, 20 * scale, 30 * scale);
  ctx.fillText("Vidas: " + lives, 20 * scale, 60 * scale);
}

function jump() {
  if (!player.jumping && !gameOver) {
    player.jumping = true;
    player.dy = -18 * scale;
  }
}

touchArea.addEventListener("touchstart", jump);
document.addEventListener("keydown", (e) => {
  if (e.code === "Space") jump();
});

function gameLoop() {
  if (gameOver) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawGround();
  drawPlayer();
  drawObstacles();
  drawHUD();

  updatePlayer();
  updateObstacles();
  detectCollision();

  score++;
  if (score % 600 === 0) gameSpeed += 0.3; // aumenta suavemente la dificultad

  requestAnimationFrame(gameLoop);
}

player.y = ground.y - player.height;
createObstacle();
gameLoop();
</script>
</body>
</html>

